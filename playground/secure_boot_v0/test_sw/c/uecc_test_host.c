#include <stdio.h>
#include <stdint.h>

#include "utils/micro-ecc/uECC.h"

int main(void) {
  const struct uECC_Curve_t *curve = uECC_secp160r1();

  static const uint8_t pub[40] = {
    0x42,0xE2,0xA8,0x0A,0xC8,0x8D,0xFB,0x6C,
    0x42,0x41,0x43,0x3F,0xF4,0xB7,0x5A,0x8E,
    0x4A,0xDB,0xDC,0xB6,0x42,0x43,0xAE,0x1C,
    0x2A,0x3F,0x70,0xD1,0x4A,0xFB,0x60,0x34,
    0x19,0x53,0xA5,0x7D,0x42,0x88,0x89,0xC9,
  };

  static const uint8_t msg[32] = {
    0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,
    0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F,0x10,
    0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,
    0x19,0x1A,0x1B,0x1C,0x1D,0x1E,0x1F,0x20,
  };

  static const uint8_t sig[40] = {
    0xF8,0x1D,0xCA,0x9D,0xD4,0x94,0xB4,0x64,
    0x9A,0x42,0xD4,0xB5,0x35,0xB1,0xB8,0xA8,
    0x69,0x42,0x5D,0xF3,0x62,0x40,0xB3,0x94,
    0x3A,0xBF,0xBF,0xDC,0xEB,0x33,0xEC,0xAE,
    0xC4,0xED,0x6B,0x5F,0xDA,0x63,0xB7,0x4D,
  };

  int ok = uECC_verify(pub, msg, sizeof(msg), sig, curve);
  if (ok) {
    printf("verify: OK\n");
    return 0;
  }

  printf("verify: FAIL\n");
  return 1;
}
